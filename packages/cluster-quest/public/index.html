<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grist Cluster Quest</title>
    
    <!-- Grist Plugin API -->
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
    
    <!-- Reveal.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/theme/black.min.css">
    
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <!-- Status Bar -->
    <div id="status-bar">
        <div class="status-item">
            <div id="connection-status"></div>
            <span id="connection-text">Connexion...</span>
        </div>
        <div class="status-item">
            <span>ğŸ‘¤ <span id="user-name">-</span></span>
        </div>
        <div class="status-item">
            <span>ğŸ¯ <span id="user-score">0</span> pts</span>
        </div>
        <div class="status-item">
            <span>ğŸ“Š Chapitre <span id="current-chapter">1</span>/9</span>
        </div>
    </div>

    <!-- User Login Modal -->
    <div id="user-login">
        <div class="login-card">
            <h2 style="text-align: center; margin-top: 0;">ğŸ® Bienvenue !</h2>
            <p style="font-size: 0.9em; text-align: center; opacity: 0.8;">
                ConnectÃ© en tant que: <strong id="grist-user-display">Chargement...</strong>
            </p>
            <button id="start-button" onclick="startSession()">ğŸš€ DÃ©marrer la Formation</button>
            <p style="font-size: 0.75em; margin-top: 1em; opacity: 0.6; text-align: center;">
                Votre progression sera enregistrÃ©e automatiquement
            </p>
            <div id="login-error" class="message-box error" style="display: none; margin-top: 1em;"></div>
        </div>
    </div>

    <div class="reveal">
        <div class="slides">
            <!-- SLIDE 0: ACCUEIL -->
            <section data-chapter="0">
                <h1>ğŸ® Grist Cluster Quest</h1>
                <h3>Formation Interactive avec Grist</h3>
                
                <div class="card">
                    <p><span class="emoji-large">ğŸ¯</span></p>
                    <p>Apprenez Ã  maÃ®triser les clusters et vecteurs<br>avec des exercices pratiques en temps rÃ©el</p>
                </div>

                <div class="card-grid">
                    <div class="card card-small">
                        <strong>9 Chapitres</strong><br>
                        <span style="font-size: 0.8em;">Progression guidÃ©e</span>
                    </div>
                    <div class="card card-small">
                        <strong>Exercices RÃ©els</strong><br>
                        <span style="font-size: 0.8em;">CrÃ©ez des donnÃ©es</span>
                    </div>
                    <div class="card card-small">
                        <strong>Multi-joueurs</strong><br>
                        <span style="font-size: 0.8em;">Comparez vos scores</span>
                    </div>
                    <div class="card card-small">
                        <strong>Progression SauvÃ©e</strong><br>
                        <span style="font-size: 0.8em;">Dans Grist</span>
                    </div>
                </div>
            </section>

            <!-- CHAPITRE 1: QUIZ SIMPLE -->
            <section>
                <section data-chapter="1">
                    <h2>ğŸ“š Chapitre 1: Les Bases</h2>
                    <span class="level-indicator level-1">DÃ©butant</span>
                    
                    <div class="card">
                        <h3>ğŸ¤” Qu'est-ce qu'un Cluster ?</h3>
                        <p style="font-size: 0.9em;">Un cluster est un <strong>groupe d'Ã©lÃ©ments similaires</strong></p>
                    </div>

                    <div class="card-grid">
                        <div class="card">
                            <span class="emoji-large">ğŸ–</span>
                            <p style="font-size: 0.85em;">Photos de plage</p>
                        </div>
                        <div class="card">
                            <span class="emoji-large">ğŸ”ï¸</span>
                            <p style="font-size: 0.85em;">Photos de montagne</p>
                        </div>
                        <div class="card">
                            <span class="emoji-large">ğŸ•</span>
                            <p style="font-size: 0.85em;">Photos de restaurants</p>
                        </div>
                    </div>
                </section>

                <section data-chapter="1">
                    <h2>ğŸ“š Exercice: Quiz</h2>
                    
                    <div class="exercise">
                        <h3>ğŸ¯ Question</h3>
                        <p>Un vecteur dans Grist capture...</p>

                        <select id="ch1-quiz">
                            <option value="">-- Choisissez --</option>
                            <option value="mots">Les mots exacts du texte</option>
                            <option value="sens">Le sens du texte</option>
                            <option value="longueur">La longueur du texte</option>
                        </select>

                        <button onclick="submitChapter1()">âœ“ Valider</button>
                        <div id="ch1-feedback" class="feedback"></div>
                    </div>
                </section>
            </section>

            <!-- CHAPITRE 2: THÃ‰ORIE -->
            <section data-chapter="2">
                <h2>ğŸ§  Chapitre 2: Comment Ã§a marche ?</h2>
                <span class="level-indicator level-1">DÃ©butant</span>
                
                <div class="card">
                    <h3>ğŸ”¢ Les Vecteurs en Action</h3>
                    <p style="font-size: 0.9em;">
                        Dans Grist, <code>CREATE_VECTOR()</code> transforme vos textes<br>
                        en reprÃ©sentations mathÃ©matiques pour la recherche
                    </p>
                </div>

                <div class="card">
                    <p style="font-size: 0.85em; text-align: left;">
                        <strong>Exemple:</strong><br>
                        â€¢ "T-shirt coton bio" â†’ [0.23, 0.45, 0.12, ...]<br>
                        â€¢ "Pull laine douce" â†’ [0.19, 0.51, 0.08, ...]<br>
                        â€¢ ProximitÃ© = SimilaritÃ© sÃ©mantique
                    </p>
                </div>
            </section>

            <!-- CHAPITRE 3: EXERCICE PRATIQUE -->
            <section>
                <section data-chapter="3">
                    <h2>ğŸ› ï¸ Chapitre 3: CrÃ©er un Produit</h2>
                    <span class="level-indicator level-2">IntermÃ©diaire</span>
                    
                    <div class="card">
                        <h3>ğŸ¯ Exercice Pratique</h3>
                        <p style="font-size: 0.9em;">
                            Vous allez crÃ©er un <strong>vrai produit</strong><br>
                            dans la table Grist avec son vecteur !
                        </p>
                    </div>

                    <div class="card" style="background: rgba(255, 193, 7, 0.1);">
                        <p style="font-size: 0.85em;">
                            ğŸ’¡ <strong>Astuce:</strong> Les donnÃ©es seront visibles<br>
                            dans la table "Exercices_Produits" du document
                        </p>
                    </div>
                </section>

                <section data-chapter="3">
                    <h2>ğŸ› ï¸ CrÃ©er Votre Produit</h2>
                    
                    <div class="exercise">
                        <h3>âœï¸ Formulaire de CrÃ©ation</h3>
                        
                        <input type="text" id="product-name" placeholder="Nom du produit (ex: T-shirt coton bio)">
                        
                        <textarea id="product-description" rows="3" placeholder="Description dÃ©taillÃ©e du produit"></textarea>
                        
                        <input type="number" id="product-price" placeholder="Prix (â‚¬)" step="0.01" min="0">
                        
                        <select id="product-category">
                            <option value="">-- CatÃ©gorie --</option>
                            <option value="VÃªtements">VÃªtements</option>
                            <option value="Ã‰lectronique">Ã‰lectronique</option>
                            <option value="Alimentation">Alimentation</option>
                            <option value="Maison">Maison</option>
                        </select>

                        <button onclick="createProduct()">ğŸš€ CrÃ©er dans Grist</button>
                        <div id="ch3-feedback" class="feedback"></div>
                    </div>

                    <div id="created-products" class="data-preview" style="display: none;">
                        <h4 style="margin-top: 0;">ğŸ“¦ Produits CrÃ©Ã©s</h4>
                        <div id="products-list"></div>
                    </div>
                </section>
            </section>

            <!-- CHAPITRE 4: RECHERCHE VECTORIELLE -->
            <section data-chapter="4">
                <h2>ğŸ” Chapitre 4: Recherche SÃ©mantique</h2>
                <span class="level-indicator level-2">IntermÃ©diaire</span>
                
                <div class="card">
                    <h3>ğŸ¯ VECTOR_SEARCH en Action</h3>
                    <p style="font-size: 0.9em;">
                        La fonction <code>VECTOR_SEARCH()</code> trouve<br>
                        les produits similaires automatiquement
                    </p>
                </div>

                <div class="card">
                    <p style="font-size: 0.85em; text-align: left;">
                        <strong>ParamÃ¨tres clÃ©s:</strong><br>
                        â€¢ <code>threshold</code>: Seuil de similaritÃ© (0-1)<br>
                        â€¢ <code>limit</code>: Nombre de rÃ©sultats<br>
                        â€¢ <code>embedding_column</code>: Colonne vectorielle spÃ©cifique
                    </p>
                </div>
            </section>

            <!-- CHAPITRE 5: MULTI-VECTEURS -->
            <section>
                <section data-chapter="5">
                    <h2>ğŸŒˆ Chapitre 5: Multi-Vecteurs</h2>
                    <span class="level-indicator level-3">AvancÃ©</span>
                    
                    <div class="card">
                        <h3>ğŸ¯ Exercice AvancÃ©</h3>
                        <p style="font-size: 0.9em;">
                            CrÃ©ez un produit avec <strong>plusieurs vecteurs</strong><br>
                            pour diffÃ©rents types de recherche
                        </p>
                    </div>

                    <div class="card">
                        <p style="font-size: 0.85em;">
                            ğŸ¨ <strong>Vecteur Marketing:</strong> Pour les clients<br>
                            ğŸ”§ <strong>Vecteur Technique:</strong> Pour les specs
                        </p>
                    </div>
                </section>

                <section data-chapter="5">
                    <h2>ğŸŒˆ Produit Multi-Aspects</h2>
                    
                    <div class="exercise">
                        <h3>âœï¸ CrÃ©ation AvancÃ©e</h3>
                        
                        <input type="text" id="adv-product-name" placeholder="Nom du produit">
                        
                        <textarea id="adv-product-marketing" rows="2" placeholder="Description marketing (pour clients)"></textarea>
                        
                        <textarea id="adv-product-technical" rows="2" placeholder="CaractÃ©ristiques techniques"></textarea>
                        
                        <input type="text" id="adv-product-tags" placeholder="Tags (sÃ©parÃ©s par des virgules)">

                        <button onclick="createAdvancedProduct()">ğŸš€ CrÃ©er avec Multi-Vecteurs</button>
                        <div id="ch5-feedback" class="feedback"></div>
                    </div>

                    <div class="card" style="margin-top: 1em; font-size: 0.85em;">
                        <p><strong>Ce produit aura 2 vecteurs:</strong></p>
                        <p>
                            ğŸ¨ <code>vecteur_marketing</code> = nom + description marketing<br>
                            ğŸ”§ <code>vecteur_technique</code> = caractÃ©ristiques techniques
                        </p>
                    </div>
                </section>
            </section>

            <!-- CHAPITRES 6-8: THÃ‰ORIE SUPPLÃ‰MENTAIRE -->
            <section data-chapter="6">
                <h2>ğŸ“ˆ Chapitre 6: Optimisation</h2>
                <span class="level-indicator level-2">IntermÃ©diaire</span>
                
                <div class="card">
                    <h3>âš™ï¸ Ajuster les ParamÃ¨tres</h3>
                    <p style="font-size: 0.9em;">
                        Le <code>threshold</code> dÃ©termine la qualitÃ© des rÃ©sultats
                    </p>
                </div>

                <div class="card-grid">
                    <div class="card">
                        <strong>Threshold Bas (0.5)</strong><br>
                        <span style="font-size: 0.8em;">Plus de rÃ©sultats, moins prÃ©cis</span>
                    </div>
                    <div class="card">
                        <strong>Threshold Ã‰levÃ© (0.9)</strong><br>
                        <span style="font-size: 0.8em;">Moins de rÃ©sultats, trÃ¨s prÃ©cis</span>
                    </div>
                </div>
            </section>

            <section data-chapter="7">
                <h2>ğŸ¨ Chapitre 7: Cas d'Usage</h2>
                <span class="level-indicator level-2">IntermÃ©diaire</span>
                
                <div class="card-grid">
                    <div class="card">
                        <span class="emoji-large">ğŸ›ï¸</span>
                        <strong>E-commerce</strong><br>
                        <span style="font-size: 0.8em;">Recommandations produits</span>
                    </div>
                    <div class="card">
                        <span class="emoji-large">â“</span>
                        <strong>Support Client</strong><br>
                        <span style="font-size: 0.8em;">FAQ intelligente</span>
                    </div>
                    <div class="card">
                        <span class="emoji-large">ğŸ“š</span>
                        <strong>Documentation</strong><br>
                        <span style="font-size: 0.8em;">Recherche sÃ©mantique</span>
                    </div>
                </div>
            </section>

            <section data-chapter="8">
                <h2>ğŸš€ Chapitre 8: Aller Plus Loin</h2>
                <span class="level-indicator level-3">AvancÃ©</span>
                
                <div class="card">
                    <h3>ğŸ’¡ Prochaines Ã‰tapes</h3>
                    <p style="font-size: 0.85em; text-align: left;">
                        â€¢ Combiner avec des filtres traditionnels<br>
                        â€¢ Utiliser plusieurs colonnes vectorielles<br>
                        â€¢ IntÃ©grer dans des workflows n8n<br>
                        â€¢ CrÃ©er des dashboards interactifs
                    </p>
                </div>
            </section>

            <!-- CHAPITRE 9: LEADERBOARD -->
            <section data-chapter="9">
                <h2>ğŸ† Classement des Participants</h2>
                
                <div id="leaderboard" class="data-preview">
                    <div class="spinner"></div>
                    <p style="text-align: center; opacity: 0.7;">Chargement du classement...</p>
                </div>

                <div class="card" style="margin-top: 1em;">
                    <h3>ğŸ‰ FÃ©licitations !</h3>
                    <p>Votre score: <strong><span id="final-score">0</span> points</strong></p>
                    <p style="font-size: 0.85em; opacity: 0.8;">
                        Temps total: <span id="final-time">-</span> minutes
                    </p>
                </div>
            </section>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.js"></script>
    <script src="./app.js"></script>
</body>
</html>